C   TIC-TAC-TOE DEMONSTRATION
C  THE ARRAY N(I,J) IS THE ARRAY OF POSITIONS TO BE CHECKED AFTER
C  EACH OPPONENT PLAY AND BEFORE EACH MACHINE PLAY.
C  ARRAY NWIN(I,J) IS THE POSITION TO PLAY TO WIN. 
      DIMENSION N(9,8), K(9), NWIN(9,8)
      DO 3 I=1,9
      READ 5,N(I,1),N(I,2),N(I,3),N(I,4),N(I,5),N(I,6),N(I,7),N(I,8)
      READ 4, NWIN(I,1),NWIN(I,2),NWIN(I,3),NWIN(I,4)
      READ 4,NWIN(I,5),NWIN(I,6),NWIN(I,7),NWIN(I,8)
    3 CONTINUE
    4 FORMAT(I2,I2,I2,I2)
    5 FORMAT(I2,I2,I2,I2,I2,I2,I2,I2)
    1 DO 6, I=1,9
    6 K(I)=0
      NCOD1=0
      NCOD2=0
      PRINT 10
   10 FORMAT(38HALL RIGHT, HERE WE GO. YOU PLAY FIRST.)
   11 PRINT 12
   12 FORMAT(42HTYPE THE POSITION NUMBER YOU WANT TO MARK.)
   14 ACCEPT 15,I
      ISAV=I
   15 FORMAT(I1)
      NSAV=0
      NSAV1=0
C   THE PROGRAM ASSUMES 1 TO BE THE MARK OF THE OPPONENT
C   THE MARK OF THE MACHINE IS 2.
      IF(K(I))17,20,17
   17 PRINT 18
   18 FORMAT(43HSTUPID. THAT PLACE HAS ALREADY BEEN PLAYED.)
      GO TO 11
   20 K(I)=1
   23 DO 32 J=1,8
      IF(N(I,J))50,50,25
   25 NP=N(I,J)
      IF(K(NP)-1)32,26,32
   26 IF(NWIN(I,J))27,32,27
   27 NP=NWIN(I,J)
      IF(SENSE SWITCH 1) 270,275
  270 IF(I-3) 275,271,275
  271 IF(J-6) 275,272,275
  272 IF(K(4)) 275,273,275
  273 K(4)=2
      NP=4
      GO TO 40
  275 IF(K(NP))29,28,29
   28 NSAV=NP
      GO TO 32
   29 IF(K(NP)-1) 1,42,32
   32 CONTINUE
      GO TO 50
   40 PRINT 41, NP
   41 FORMAT(16HI PLAY POSITION I2, 12H YOUR TURN. )
      GO TO 14
   42 PRINT 43
   43 FORMAT(41HWHAT HAPPENED. YOU WIN. CONGRATULATIONS. )
  430 PRINT 44
   44 FORMAT(36HIF YOU WAN TO PLAY AGAIN TYPE A 1. )
      PRINT 440
  440 FORMAT(17HIF NOT, TYPE A 2.) 
      ACCEPT 15, ISTP
      IF(ISTP-1)85,1,441
  441 PRINT 442
  442 FORMAT(25HHA HA. YOU ARE A QUITTER.)
      PRINT 443
  443 FORMAT(30HBUT THANKS FOR THE FUN ANYWAY.)
      GO TO 85
   45 PRINT 46
   46 FORMAT(37HSORRY PAL. I GUESS YOU DID YOUR BEST.)
      PRINT 47
   47 FORMAT(41HYOU REALLY DIDNT HAVE A CHANCE, YOU KNOW.)
      GO TO 430
   50 DO 520 L=1,9
      KNT=0
      IF(K(L))520,501,520
  501 DO 510 J=1,8
      IF(N(L,J)) 520,520,503
  503 NP=N(L,J)
      IF(K(NP)-1) 510,505,510
  505 NP=NWIN(L,J)
      IF(K(NP)-1) 506,506,510
  506 KNT=KNT+1
      IF(2-KNT) 512,512,510
  510 CONTINUE
      GO TO 520
  512 NSAV1=L
      GO TO 51
  520 CONTINUE
   51 DO 60 I=1,9
      IF(K(I))52,60,52
   52 IF(K(I)-2)60,53,60
   53 DO 59 J=1,8
      IF(N(I,J)) 60,60,54
   54 NP=N(I,J)
      IF(K(NP)-2)59,55,59
   55 IF(NWIN(I,J))59,59,56
   56 NP=NWIN(I,J)
      IF(K(NP))59,57,59
   57 K(NP)=2
      PRINT 58,NP
   58 FORMAT(16HI PLAY POSITION I2, 27H, AND THAT MAKES ME WINNER.)
      GO TO 45
   59 CONTINUE
   60 CONTiNUE
  601 IF(NSAV) 605,605,600
  600 IF(K(NSAV)) 599,599,605
  599  K(NSAV)=2
      NP=NSAV
      GO TO 40
  605 IF(NCOD1) 607,607,21
  607 IF(NCOD2)604,604,609
   21 IF(K(8)) 22,22,604
   22 K(8)=2
      NP=8
      GO TO 40
  609 IF(K(2)) 612,612,604
  612 K(2)=2
      NP=2
      GO TO 40
  604 DO 625 L=1,9
      KNT=0
      IF(K(L)) 625,606,625
  606 DO 615 J=1,8
      IF(N(L,J))625,625,608
  608 NP=N(L,J)
      IF(K(NP)-2) 625,610,625
  610 NP=NWIN(L,J)
      IF(K(NP)) 625,610,615
  611 KNT=KNT+1
      IF(2-KNT) 617,617,615
  615 CONTINUE
      GO TO 625
  617 K(L)=2
      NP=L
      GO TO 40
  625 CONTINUE
      IF(NSAV1) 61,61,626
  626 IF(K(NSAV1)) 61,627,61
  627 K(NSAV1)=2
      NP=NSAV1
      GO TO 40
   61 IF(ISAV-1)633,630,633
  630 IF(K(5)) 631,631,650
  631 K(5)=2
      NCOD1=1
      GO TO 40
  633 IF(ISAV-3) 635,630,635
  635 IF(ISAV-7)640,636,640
  636 IF(K(5)) 638,638,650
  638 K(5)=2
      NP=5
      NCOD2=1
      GO TO 40
  640 IF(ISAV-9) 650,636,650
  650 IF(K(5)) 64,62,64
   62 NP=5
      K(5)=5
      GO TO 40
   64 IF(K(I)) 67,65,67
   65 NP=1
      K(1)+2 
      GO TO 40
   67 IF(K(3)) 70,68,70
   68 NP=3
      K(3)=2
      GO TO 40
   70 IF(K(7))73,71,73
   71 NP=7
      K(7)=2
      GO TO 40
   73 IF(K(9)) 76,74,76
   74 NP=9
      K(9)=2
      GO TO 40
   76 DO 80 J=2,8,2
      IF(K(J))80,77,80
   77 NP=J
      K(J)=2
      GO TO 40
   80 CONTINUE
      PRINT 81
   81 FORMAT(43HLOOKS LIKE A DRAW. YOU PUT UP A GOOD FIGHT.)
      GO TO 430
   85 PAUSE
      GO TO 1
      END
